@using TechNova.Models.Core
@model IEnumerable<Product>
@{
    ViewData["Title"] = "Store";
    var categories = ViewBag.Categories as List<Category>;

    // Ép kiểu Model rõ ràng
    var productList = Model.ToList(); // ép về List<Product>
    var saleProducts = productList.Where(p => p.DiscountPercent > 0).ToList();
}

<section class="store-section">
    <div class="store-intro">
        <span class="intro-text">
            Nơi mua sắm các sản phẩm <strong class="highlight">hot</strong>
        </span>
    </div>
    
    <h2 class="section-title">Sản phẩm sale sập sàn</h2>

    <div class="carousel-wrapper">
        <button class="carousel-btn prev">&#10094;</button>
        <div class="product-carousel" id="productCarousel">
            @foreach (var product in saleProducts)
            {
                <a href="@Url.Action("ProductDetails", "Home", new { id = product.ProductId })" class="product-card sale-card">
                    <img src="@Url.Content(product.MainImageUrl)" alt="@product.Name" />
                    <h3>@product.Name</h3>
                    <p class="original-price">@product.Price.ToString("N0") ₫</p>
                    <p class="discounted-price">@product.DiscountedPrice.ToString("N0") ₫</p>
                </a>
            }
        </div>
        <button class="carousel-btn next">&#10095;</button>
    </div>
    <section class="benefit-section">
        <div class="benefit-container">
            <div class="benefit-card">
                <div class="benefit-icon">🔒</div>
                <h4>Uy tín hàng đầu</h4>
                <p>Cam kết hàng chính hãng, bảo hành minh bạch.</p>
            </div>
            <div class="benefit-card">
                <div class="benefit-icon">🚚</div>
                <h4>Giao hàng nhanh</h4>
                <p>Miễn phí nội thành, toàn quốc từ 2–5 ngày.</p>
            </div>
            <div class="benefit-card">
                <div class="benefit-icon">📞</div>
                <h4>Hỗ trợ 24/7</h4>
                <p>Đội ngũ tư vấn nhiệt tình, luôn sẵn sàng giúp đỡ.</p>
            </div>
            <div class="benefit-card">
                <div class="benefit-icon">💰</div>
                <h4>Giá tốt mỗi ngày</h4>
                <p>Luôn có khuyến mãi và giá cạnh tranh nhất.</p>
            </div>
        </div>
    </section>


</section>

<script>
    const carousel = document.getElementById("productCarousel");
    const prevBtn = document.querySelector(".carousel-btn.prev");
    const nextBtn = document.querySelector(".carousel-btn.next");

    const scrollAmount = 400 * 3 + 20; // 3 cards mỗi lần, thêm khoảng cách

    prevBtn.addEventListener("click", () => {
        carousel.scrollBy({ left: -scrollAmount, behavior: 'smooth' });
    });

    nextBtn.addEventListener("click", () => {
        carousel.scrollBy({ left: scrollAmount, behavior: 'smooth' });
    });
</script>
